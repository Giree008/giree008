stage('Backend Build') {
  agent {
    docker { image 'maven:3.8.1-adoptopenjdk-11' }
  }
  steps {
    dir('backend') {
      sh 'mvn clean package'
    }
  }
}

stage('Frontend Build') {
  agent {
    docker { image 'node:16-alpine' }
  }
  steps {
    dir('frontend') {
      sh 'npm install'
      sh 'npm test'
      sh 'npm run build'
    }
  }
}

stage('Docker Image Build') {
  agent any
  steps {
    sh 'docker build -t backend-app backend'
    sh 'docker build -t frontend-app frontend'
  }
}
